import{f as u,j as e,_ as t,P as H,L as Q,m as Y,R as Z,a as ee,b as te,r as ae,e as re,i as se,c as ne,d as ie}from"./index-DP0kblqF.js";const le=({isOpen:m,onClose:x,taxonomy:l,postType:y,postId:d,onTermCreated:b})=>{const[h,j]=u.useState({name:"",description:"",parent_id:""}),[n,f]=u.useState({}),[v,N]=u.useState(!1);u.useEffect(()=>{m&&(j({name:"",description:"",parent_id:""}),f({}))},[m]),u.useEffect(()=>(m?document.body.classList.add("overflow-hidden"):document.body.classList.remove("overflow-hidden"),()=>document.body.classList.remove("overflow-hidden")),[m]),u.useEffect(()=>{const o=w=>{w.key==="Escape"&&m&&x()};return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[m,x]);const g=async()=>{if(!v){if(!h.name||h.name.trim()===""){f({name:t("Name is required")});return}N(!0),f({});try{const w=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||"",k=await fetch(`/api/admin/terms/${l.name}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":w},body:JSON.stringify({name:h.name.trim(),description:h.description.trim(),parent_id:h.parent_id||null,taxonomy:l.name,post_type:y,post_id:d})}),a=await k.json();if(!k.ok){if(k.status===422&&a.errors){f(a.errors);return}throw new Error(a.message||"An error occurred")}a.term&&(b(a.term),x(),typeof window.showToast=="function"&&window.showToast("success",t("Success"),a.message||t("Term created successfully")))}catch(o){console.error("Error saving term:",o),typeof window.showToast=="function"&&window.showToast("error",t("Error"),o.message||t("Failed to create term"))}finally{N(!1)}}},S=(o,w=null,k=0)=>{const a=[];return o.filter(i=>i.parent_id===w).forEach(i=>{const p="â€” ".repeat(k);a.push({value:i.id,label:p+i.name}),a.push(...S(o,i.id,k+1))}),a},C=l.hierarchical?S(l.terms||[]):[];return m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-gray-900/30 backdrop-blur-sm z-[60]",onClick:x}),e.jsxs("div",{className:"fixed top-0 right-0 bottom-0 w-full sm:w-96 max-w-full z-[70] flex flex-col bg-white dark:bg-gray-800 shadow-xl border-l border-gray-200 dark:border-gray-700 transform transition-transform duration-300",children:[e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-base font-medium text-gray-700 dark:text-white",children:t("Add New :taxonomy").replace(":taxonomy",l.label_singular||l.label)}),e.jsx("button",{type:"button",onClick:x,className:"text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-gray-200",children:e.jsx("iconify-icon",{icon:"mdi:close",width:"20",height:"20"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[t("Name")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:h.name,onChange:o=>j({...h,name:o.target.value}),className:"form-control",placeholder:t("Enter name"),autoFocus:!0}),n.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t("Description")}),e.jsx("textarea",{value:h.description,onChange:o=>j({...h,description:o.target.value}),rows:3,className:"form-control !h-20",placeholder:t("Enter description (optional)")}),n.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.description})]}),l.hierarchical&&C.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t("Parent :taxonomy").replace(":taxonomy",l.label_singular||l.label)}),e.jsxs("select",{value:h.parent_id,onChange:o=>j({...h,parent_id:o.target.value}),className:"form-control",children:[e.jsx("option",{value:"",children:t("None")}),C.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]})]})]}),e.jsx("div",{className:"px-5 py-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:g,disabled:v,className:"btn-primary flex items-center gap-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx("iconify-icon",{icon:"mdi:loading",className:"animate-spin",width:"16",height:"16"}),t("Saving...")]}):t("Save")}),e.jsx("button",{type:"button",onClick:x,className:"btn-default",children:t("Cancel")})]})})]})]}):null},K=({terms:m,taxonomyName:x,selectedTerms:l,onTermToggle:y,parentId:d=null,level:b=0})=>{const h=d===null||d===""||d===void 0?null:parseInt(d,10),j=m.filter(n=>(n.parent_id===null||n.parent_id===""||n.parent_id===void 0?null:parseInt(n.parent_id,10))===h);return j.length===0?null:e.jsx(e.Fragment,{children:j.map(n=>{const f=parseInt(n.id,10),v=(l[x]||[]).includes(f),N=m.some(g=>(g.parent_id===null||g.parent_id===""||g.parent_id===void 0?null:parseInt(g.parent_id,10))===f);return e.jsxs("div",{children:[e.jsx("div",{className:`flex items-start py-1 ${b>0?"ml-4 border-l border-gray-200 dark:border-gray-700 pl-2":""}`,children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-1 rounded flex-1",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:()=>y(x,n.id),className:"form-checkbox h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:n.name})]})}),N&&e.jsx(K,{terms:m,taxonomyName:x,selectedTerms:l,onTermToggle:y,parentId:n.id,level:b+1})]},n.id)})})},oe=({terms:m,taxonomyName:x,selectedTerms:l,onTermToggle:y})=>e.jsx(e.Fragment,{children:m.map(d=>{const b=(l[x]||[]).includes(d.id);return e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-1 rounded",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:()=>y(x,d.id),className:"form-checkbox h-4 w-4 text-primary rounded border-gray-300 dark:border-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:d.name})]},d.id)})}),ce=({taxonomies:m,selectedTerms:x,onTermToggle:l,onTermsUpdate:y,postType:d,postId:b})=>{const[h,j]=u.useState({}),[n,f]=u.useState(null),[v,N]=u.useState({}),[g,S]=u.useState(m);u.useEffect(()=>{S(m)},[m]);const C=u.useCallback(a=>{j(s=>({...s,[a]:s[a]===void 0?!1:!s[a]}))},[]),o=u.useCallback(a=>{const s={...a,id:parseInt(a.id,10),parent_id:a.parent_id?parseInt(a.parent_id,10):null};S(i=>i.map(p=>p.name===s.taxonomy?{...p,terms:[...p.terms||[],s]}:p)),l(s.taxonomy,s.id),y&&y(g)},[g,l,y]),w=u.useCallback((a,s)=>{N(i=>({...i,[a]:s}))},[]),k=u.useCallback((a,s)=>{if(!s)return a;const i=s.toLowerCase();return a.filter(p=>p.name.toLowerCase().includes(i))},[]);return!g||g.length===0?null:e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 pb-2 border-b border-gray-200 dark:border-gray-700",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t("Taxonomies")})}),g.map(a=>{const s=h[a.name]!==!1,i=v[a.name]||"",p=a.terms||[],E=k(p,i),_=(x[a.name]||[]).length;return e.jsxs("div",{className:"mb-4 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-gray-800 px-3 py-2",children:[e.jsxs("button",{type:"button",onClick:()=>C(a.name),className:"flex items-center gap-2 flex-1 text-left text-sm font-medium text-gray-700 dark:text-gray-200 hover:text-gray-900 dark:hover:text-white",children:[e.jsx("iconify-icon",{icon:s?"mdi:chevron-down":"mdi:chevron-right",width:"18",height:"18"}),e.jsx("span",{children:a.label}),_>0&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 text-xs bg-primary/10 text-primary rounded-full",children:_})]}),e.jsx("button",{type:"button",onClick:()=>f(a),className:"p-1 text-gray-500 hover:text-primary dark:text-gray-400 dark:hover:text-primary transition-colors",title:t("Add New :taxonomy").replace(":taxonomy",a.label_singular||a.label),children:e.jsx("iconify-icon",{icon:"mdi:plus-circle",width:"20",height:"20"})})]}),s&&e.jsxs("div",{className:"p-3",children:[p.length>8&&e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"relative",children:[e.jsx("iconify-icon",{icon:"mdi:magnify",width:"16",height:"16",class:"absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:O=>w(a.name,O.target.value),placeholder:t("Search :items...").replace(":items",a.label.toLowerCase()),className:"form-control pl-8 py-1.5 text-sm"})]})}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:E.length>0?a.hierarchical?e.jsx(K,{terms:E,taxonomyName:a.name,selectedTerms:x,onTermToggle:l}):e.jsx(oe,{terms:E,taxonomyName:a.name,selectedTerms:x,onTermToggle:l}):e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 py-2 text-center",children:i?t("No matching :items").replace(":items",a.label.toLowerCase()):t("No :items found").replace(":items",a.label.toLowerCase())})})]})]},a.name)}),n&&e.jsx(le,{isOpen:!!n,onClose:()=>f(null),taxonomy:n,postType:d,postId:b,onTermCreated:o})]})},de=({selectedBlock:m,onUpdate:x,onImageUpload:l,onVideoUpload:y,canvasSettings:d,onCanvasSettingsUpdate:b,title:h,setTitle:j,slug:n,setSlug:f,generateSlug:v,status:N,setStatus:g,excerpt:S,setExcerpt:C,publishedAt:o,setPublishedAt:w,parentId:k,setParentId:a,selectedTerms:s,setSelectedTerms:i,featuredImage:p,setFeaturedImage:E,removeFeaturedImage:_,setRemoveFeaturedImage:O,taxonomies:J,parentPosts:I,postTypeModel:P,statuses:M,postData:L,postType:A})=>{const[R,V]=u.useState(!1),[D,q]=u.useState(!1),F=`${window.location.origin}/admin/posts/${A||"page"}/${L?.id||n||L?.slug}`,z=()=>{navigator.clipboard.writeText(F),q(!0),setTimeout(()=>q(!1),2e3)},X=async()=>{try{const r=await Y.selectImage();r&&(E(r.url),O(!1))}catch{}},W=(r,T)=>{i($=>{const U=$[r]||[],B=U.includes(T)?U.filter(G=>G!==T):[...U,T];return{...$,[r]:B}})};return m?e.jsx(H,{selectedBlock:m,onUpdate:x,onImageUpload:l,onVideoUpload:y,canvasSettings:d,onCanvasSettingsUpdate:b}):e.jsxs("div",{className:"h-full overflow-y-auto px-1",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 pb-2 border-b border-gray-200",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:t(":type Details").replace(":type",P.label_singular)})}),e.jsxs("div",{className:"mb-4 md:hidden",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("Title")}),e.jsx("input",{type:"text",value:h,onChange:r=>j(r.target.value),className:"form-control",placeholder:t("Enter title...")})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("Slug")}),e.jsxs("div",{className:"flex gap-2",children:[R?e.jsx("input",{type:"text",value:n,onChange:r=>f(r.target.value),className:"form-control flex-1",placeholder:"post-slug"}):e.jsx("div",{className:"flex-1 px-3 py-2 bg-gray-50 border border-gray-200 rounded-md text-sm text-gray-600 truncate",children:n||e.jsx("span",{className:"text-gray-400 italic",children:t("auto-generated")})}),e.jsx("button",{type:"button",onClick:()=>V(!R),className:"btn-default px-3 py-2 text-xs",children:R?t("OK"):t("Edit")}),e.jsx("button",{type:"button",onClick:v,className:"btn-default px-3 py-2 text-xs",title:t("Generate from title"),children:e.jsx("iconify-icon",{icon:"mdi:refresh",width:"16",height:"16"})})]}),(L?.id||n)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:t("Permalink")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 px-2 py-1.5 bg-gray-50 border border-gray-200 rounded text-xs text-gray-500 truncate font-mono",children:F}),L?.id&&n&&e.jsx("a",{href:F,target:"_blank",rel:"noopener noreferrer",className:"btn-default px-2 py-1.5 text-xs",title:t("View page"),children:e.jsx("iconify-icon",{icon:"mdi:open-in-new",width:"14",height:"14"})}),e.jsx("button",{type:"button",onClick:z,className:`btn-default px-2 py-1.5 text-xs ${D?"text-green-600":""}`,title:D?t("Copied!"):t("Copy URL"),children:e.jsx("iconify-icon",{icon:D?"mdi:check":"mdi:content-copy",width:"14",height:"14"})})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 pb-2 border-b border-gray-200",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:t("Status & Visibility")})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("Status")}),e.jsx("select",{value:N,onChange:r=>g(r.target.value),className:"form-control",children:Object.entries(M).map(([r,T])=>e.jsx("option",{value:r,children:T},r))})]}),N==="scheduled"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("Publish Date")}),e.jsx("input",{type:"datetime-local",value:o,onChange:r=>w(r.target.value),className:"form-control"})]})]}),P.supports_thumbnail&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 pb-2 border-b border-gray-200",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:t("Featured Image")})}),e.jsxs("div",{className:"space-y-2",children:[p&&!_?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:p,alt:"Featured",className:"w-full h-32 object-contain rounded-lg border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"}),e.jsx("button",{type:"button",onClick:()=>{E(""),O(!0)},className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:t("Remove image"),children:e.jsx("iconify-icon",{icon:"mdi:close",width:"14",height:"14"})})]}):e.jsxs("div",{onClick:X,className:"flex flex-col items-center justify-center w-full h-32 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:border-primary hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("iconify-icon",{icon:"mdi:image-plus",className:"text-3xl text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("Click to select image")})]}),p&&!_&&e.jsxs("button",{type:"button",onClick:X,className:"btn btn-default w-full flex items-center justify-center gap-2",children:[e.jsx("iconify-icon",{icon:"mdi:image-edit",width:"16",height:"16"}),t("Change Image")]})]})]}),P.supports_excerpt&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 pb-2 border-b border-gray-200",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:t("Excerpt")})}),e.jsx("textarea",{value:S,onChange:r=>C(r.target.value),rows:3,className:"form-control-textarea",placeholder:t("A short summary of the content...")}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:t("Leave empty to auto-generate from content")})]}),P.hierarchical&&Object.keys(I).length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 pb-2 border-b border-gray-200",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:t("Parent :type").replace(":type",P.label_singular)})}),e.jsxs("select",{value:k,onChange:r=>a(r.target.value),className:"form-control",children:[e.jsx("option",{value:"",children:t("None")}),Object.entries(I).map(([r,T])=>e.jsx("option",{value:r,children:T},r))]})]}),J.length>0&&e.jsx(ce,{taxonomies:J,selectedTerms:s,onTermToggle:W,postType:A,postId:L?.id}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"mb-4 pb-2 border-b border-gray-200",children:e.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:t("Content Settings")})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("Content Width")}),e.jsxs("select",{value:d?.width||"100%",onChange:r=>b({...d,width:r.target.value}),className:"form-control",children:[e.jsx("option",{value:"100%",children:t("Full Width")}),e.jsx("option",{value:"800px",children:t("800px (Narrow)")}),e.jsx("option",{value:"1000px",children:t("1000px (Standard)")}),e.jsx("option",{value:"1200px",children:t("1200px (Wide)")})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t("Content Padding")}),e.jsxs("select",{value:d?.contentPadding||"24px",onChange:r=>b({...d,contentPadding:r.target.value}),className:"form-control",children:[e.jsx("option",{value:"0px",children:t("None")}),e.jsx("option",{value:"16px",children:t("16px (Compact)")}),e.jsx("option",{value:"24px",children:t("24px (Small)")}),e.jsx("option",{value:"32px",children:t("32px (Medium)")}),e.jsx("option",{value:"40px",children:t("40px (Large)")})]})]})]}),e.jsx(Q,{layoutStyles:d?.layoutStyles||{},onUpdate:r=>b({...d,layoutStyles:r}),onImageUpload:l,defaultCollapsed:!1}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsx("p",{className:"text-xs text-gray-400 text-center",children:t("Click on a block to edit its properties")})})]})};typeof window<"u"&&(window.React=Z,window.ReactDOM=ee,window.ReactJSXRuntime=te);ae(re);const c=document.getElementById("lara-builder-root");if(c){const m=c.dataset.context||"page",x=c.dataset.initialData?JSON.parse(c.dataset.initialData):null,l=c.dataset.postData?JSON.parse(c.dataset.postData):null,y=c.dataset.saveUrl,d=c.dataset.listUrl,b=c.dataset.uploadUrl,h=c.dataset.videoUploadUrl,j=c.dataset.taxonomies?JSON.parse(c.dataset.taxonomies):[],n=c.dataset.selectedTerms?JSON.parse(c.dataset.selectedTerms):{},f=c.dataset.parentPosts?JSON.parse(c.dataset.parentPosts):{},v=c.dataset.postType||"post",N=c.dataset.postTypeModel?JSON.parse(c.dataset.postTypeModel):{},g=c.dataset.statuses?JSON.parse(c.dataset.statuses):{},S=c.dataset.translations?JSON.parse(c.dataset.translations):{};se(S);const C=async a=>{if(!b)throw new Error("Upload URL not configured");const s=new FormData;s.append("image",a);const i=await fetch(b,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content,Accept:"application/json"},body:s});if(!i.ok){const p=await i.json().catch(()=>({}));throw new Error(p.message||"Failed to upload image")}return await i.json()},o=async(a,s)=>{if(!h)throw new Error("Video upload URL not configured");const i=new FormData;i.append("video",a),s&&i.append("thumbnail",s);const p=await fetch(h,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content,Accept:"application/json"},body:i});if(!p.ok){const E=await p.json().catch(()=>({}));throw new Error(E.message||"Failed to upload video")}return await p.json()},w=async a=>{if(!y)throw new Error("Save URL not configured");const s=await fetch(y,{method:l?.id?"PUT":"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content,Accept:"application/json"},body:JSON.stringify(a)});if(!s.ok){const i=await s.json().catch(()=>({}));throw new Error(i.message||"Failed to save")}return await s.json()};ne.createRoot(c).render(e.jsx(ie,{context:m,initialData:x,postData:l,onSave:w,onImageUpload:C,onVideoUpload:o,listUrl:d,taxonomies:j,selectedTerms:n,parentPosts:f,postType:v,postTypeModel:N,statuses:g,PropertiesPanelComponent:de}))}
